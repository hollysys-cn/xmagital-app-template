# 功能规格说明书：B/S 架构 Monorepo 设置与学生 CRUD 示例

**特性分支**: `001-bs-monorepo-setup`
**创建日期**: 2025-11-27
**状态**: 草稿
**输入**: 用户描述："主要目标：构建一个mono仓库，使用B/S架构，遵循OpenAPI规范，包含前后端代码和详细文档... (见完整提示)"

## 用户场景与测试 *(必填)*

### 用户故事 1 - 项目初始化与环境设置 (优先级: P1)

作为一名开发者，我希望初始化一个预配置了 B/S 架构和开发环境的 Monorepo，以便我可以立即开始开发，无需手动配置。

**优先级理由**: 这是整个模板的基础。

**独立测试**: 可以通过克隆仓库、安装依赖并验证环境配置来测试。

**验收场景**:

1.  **给定** 一个新克隆的仓库，**当** 我使用 `pnpm` 和 `uv` 安装依赖时，**那么** 所有包都应从配置的阿里镜像源安装。
2.  **给定** 已安装的环境，**当** 我检查 Node.js 版本时，**那么** 它应要求/匹配 22.10+。
3.  **给定** 已安装的环境，**当** 我检查 Python 版本时，**那么** 它应要求/匹配 3.13+。
4.  **给定** 项目结构，**当** 我检查文件夹时，**那么** 我应看到 Monorepo 结构中前后端的清晰分离。

---

### 用户故事 2 - 学生 CRUD 示例 (优先级: P1)

作为一名开发者，我希望看到一个端到端的“学生”管理功能示例，以便我了解如何使用提供的技术栈 (Vue3 + FastAPI + SQLite) 实现 CRUD 操作。

**优先级理由**: 为开发者提供“参考实现”以供学习。

**独立测试**: 可以通过运行应用程序并在浏览器中执行 CRUD 操作来测试。

**验收场景**:

1.  **给定** 应用程序正在运行，**当** 我导航到学生页面时，**那么** 我应看到从后端获取的学生列表。
2.  **给定** 学生页面，**当** 我填写表单并点击“添加”时，**那么** 一个新学生应在 SQLite 数据库中创建并出现在列表中。
3.  **给定** 一个现有的学生，**当** 我编辑其详细信息并保存时，**那么** 更新应反映在数据库和 UI 中。
4.  **给定** 一个现有的学生，**当** 我点击“删除”时，**那么** 该学生应从列表和数据库中移除。
5.  **给定** 应用程序正在运行，**当** 我访问 API 文档 (Swagger/OpenAPI) 时，**那么** 我应看到已定义的学生端点。

### 边缘情况

-   **网络故障**: 如果依赖安装因网络问题失败，设置脚本应提供清晰的错误消息，并建议检查镜像配置。
-   **端口冲突**: 如果默认端口（例如前端 3000，后端 8000）被占用，启动脚本应优雅地失败或允许通过环境变量配置端口。
-   **清理脚本幂等性**: 如果清理脚本运行多次，它不应失败或在后续运行中造成损坏。

---

### 用户故事 3 - 示例清理脚本 (优先级: P2)

作为一名开发者，我希望运行一个脚本来自动删除学生 CRUD 示例代码，以便我可以为自己的业务逻辑拥有一个干净的起点。

**优先级理由**: 确保模板可用于实际项目，无需手动清理。

**独立测试**: 可以通过运行脚本并验证文件删除和代码修改来测试。

**验收场景**:

1.  **给定** 包含学生示例的项目，**当** 我运行清理脚本时，**那么** 所有与学生相关的文件（前端视图、后端模型/路由）都应被删除。
2.  **给定** 清理脚本已运行，**当** 我尝试启动应用程序时，**那么** 它应成功启动且无错误（路由已取消注册）。
3.  **给定** 清理脚本已运行，**当** 我检查数据库时，**那么** 学生表结构应不再被引用/处于活动状态（或迁移文件已删除/回滚）。

## 需求 *(必填)*

### 功能需求

-   **FR-001**: 系统必须构建为包含前端和后端代码的 Monorepo。
-   **FR-002**: 前端必须使用 **Node.js 22.10+**, **Pnpm**, **Vite**, **Vue 3**, **TypeScript**, **Element-plus**, **Echarts**, **Three.js**, 和 **axios**。
-   **FR-003**: 后端必须使用 **Python 3.13+**, **uv** (包管理器), **FastAPI**, **Pydantic**, **asyncio**, **requests**, 和 **Psycopg**。
-   **FR-004**: 数据库必须为 **SQLite** 作为默认配置和示例。
-   **FR-005**: 系统必须配置为使用 **阿里云镜像** 用于 NPM (https://npmmirror.com/) 和 PyPI (https://developer.aliyun.com/mirror/pypi)。
-   **FR-006**: 后端必须为所有 API 端点暴露 **OpenAPI** 规范 (Swagger UI)。
-   **FR-007**: 系统必须实现具有基本属性（例如姓名、年龄、学号）的“学生”实体。
-   **FR-008**: 系统必须实现学生的创建、读取、更新、删除 (CRUD)。
-   **FR-009**: 系统必须提供一个脚本（例如 shell 或 python）来删除学生示例代码及其引用。
-   **FR-010**: 前端必须包含一个使用 **Echarts** 或 **Three.js** 的可视化组件（例如与学生相关的简单图表或 3D 视图，或者仅仅是一个演示页面）以验证集成。

### 关键实体 *(如果特性涉及数据则包含)*

-   **Student (学生)**:
    -   `id`: 唯一标识符 (Integer/UUID)
    -   `name`: 姓名 (String)
    -   `age`: 年龄 (Integer)
    -   `student_number`: 学号 (String)
    -   `grade`: 年级 (String, 可选)

## 成功标准 *(必填)*

### 可衡量的结果

-   **SC-001**: 开发者可以在 5 分钟内安装所有依赖并启动开发服务器（假设平均网速）。
-   **SC-002**: 学生 CRUD 示例通过所有手动验收测试（创建、读取、更新、删除）。
-   **SC-003**: 清理脚本移除 100% 的“学生”领域代码，保留基础架构完整。
-   **SC-004**: 应用程序达到 Lighthouse 可访问性评分 >80 (基本可用性)。

